{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.convertPatternGroupToTask = exports.convertPatternGroupsToTasks = exports.groupPatternsByBaseDirectory = exports.getNegativePatternsAsPositive = exports.getPositivePatterns = exports.convertPatternsToTasks = exports.generate = void 0;\n\nconst utils = require(\"../utils\");\n\nfunction generate(patterns, settings) {\n  const positivePatterns = getPositivePatterns(patterns);\n  const negativePatterns = getNegativePatternsAsPositive(patterns, settings.ignore);\n  const staticPatterns = positivePatterns.filter(pattern => utils.pattern.isStaticPattern(pattern, settings));\n  const dynamicPatterns = positivePatterns.filter(pattern => utils.pattern.isDynamicPattern(pattern, settings));\n  const staticTasks = convertPatternsToTasks(staticPatterns, negativePatterns,\n  /* dynamic */\n  false);\n  const dynamicTasks = convertPatternsToTasks(dynamicPatterns, negativePatterns,\n  /* dynamic */\n  true);\n  return staticTasks.concat(dynamicTasks);\n}\n\nexports.generate = generate;\n/**\n * Returns tasks grouped by basic pattern directories.\n *\n * Patterns that can be found inside (`./`) and outside (`../`) the current directory are handled separately.\n * This is necessary because directory traversal starts at the base directory and goes deeper.\n */\n\nfunction convertPatternsToTasks(positive, negative, dynamic) {\n  const tasks = [];\n  const patternsOutsideCurrentDirectory = utils.pattern.getPatternsOutsideCurrentDirectory(positive);\n  const patternsInsideCurrentDirectory = utils.pattern.getPatternsInsideCurrentDirectory(positive);\n  const outsideCurrentDirectoryGroup = groupPatternsByBaseDirectory(patternsOutsideCurrentDirectory);\n  const insideCurrentDirectoryGroup = groupPatternsByBaseDirectory(patternsInsideCurrentDirectory);\n  tasks.push(...convertPatternGroupsToTasks(outsideCurrentDirectoryGroup, negative, dynamic));\n  /*\n   * For the sake of reducing future accesses to the file system, we merge all tasks within the current directory\n   * into a global task, if at least one pattern refers to the root (`.`). In this case, the global task covers the rest.\n   */\n\n  if ('.' in insideCurrentDirectoryGroup) {\n    tasks.push(convertPatternGroupToTask('.', patternsInsideCurrentDirectory, negative, dynamic));\n  } else {\n    tasks.push(...convertPatternGroupsToTasks(insideCurrentDirectoryGroup, negative, dynamic));\n  }\n\n  return tasks;\n}\n\nexports.convertPatternsToTasks = convertPatternsToTasks;\n\nfunction getPositivePatterns(patterns) {\n  return utils.pattern.getPositivePatterns(patterns);\n}\n\nexports.getPositivePatterns = getPositivePatterns;\n\nfunction getNegativePatternsAsPositive(patterns, ignore) {\n  const negative = utils.pattern.getNegativePatterns(patterns).concat(ignore);\n  const positive = negative.map(utils.pattern.convertToPositivePattern);\n  return positive;\n}\n\nexports.getNegativePatternsAsPositive = getNegativePatternsAsPositive;\n\nfunction groupPatternsByBaseDirectory(patterns) {\n  const group = {};\n  return patterns.reduce((collection, pattern) => {\n    const base = utils.pattern.getBaseDirectory(pattern);\n\n    if (base in collection) {\n      collection[base].push(pattern);\n    } else {\n      collection[base] = [pattern];\n    }\n\n    return collection;\n  }, group);\n}\n\nexports.groupPatternsByBaseDirectory = groupPatternsByBaseDirectory;\n\nfunction convertPatternGroupsToTasks(positive, negative, dynamic) {\n  return Object.keys(positive).map(base => {\n    return convertPatternGroupToTask(base, positive[base], negative, dynamic);\n  });\n}\n\nexports.convertPatternGroupsToTasks = convertPatternGroupsToTasks;\n\nfunction convertPatternGroupToTask(base, positive, negative, dynamic) {\n  return {\n    dynamic,\n    positive,\n    negative,\n    base,\n    patterns: [].concat(positive, negative.map(utils.pattern.convertToNegativePattern))\n  };\n}\n\nexports.convertPatternGroupToTask = convertPatternGroupToTask;","map":{"version":3,"sources":["/home/alan/delivery_2/previously_on/client/node_modules/fast-glob/out/managers/tasks.js"],"names":["Object","defineProperty","exports","value","convertPatternGroupToTask","convertPatternGroupsToTasks","groupPatternsByBaseDirectory","getNegativePatternsAsPositive","getPositivePatterns","convertPatternsToTasks","generate","utils","require","patterns","settings","positivePatterns","negativePatterns","ignore","staticPatterns","filter","pattern","isStaticPattern","dynamicPatterns","isDynamicPattern","staticTasks","dynamicTasks","concat","positive","negative","dynamic","tasks","patternsOutsideCurrentDirectory","getPatternsOutsideCurrentDirectory","patternsInsideCurrentDirectory","getPatternsInsideCurrentDirectory","outsideCurrentDirectoryGroup","insideCurrentDirectoryGroup","push","getNegativePatterns","map","convertToPositivePattern","group","reduce","collection","base","getBaseDirectory","keys","convertToNegativePattern"],"mappings":"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","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.convertPatternGroupToTask = exports.convertPatternGroupsToTasks = exports.groupPatternsByBaseDirectory = exports.getNegativePatternsAsPositive = exports.getPositivePatterns = exports.convertPatternsToTasks = exports.generate = void 0;\nconst utils = require(\"../utils\");\nfunction generate(patterns, settings) {\n    const positivePatterns = getPositivePatterns(patterns);\n    const negativePatterns = getNegativePatternsAsPositive(patterns, settings.ignore);\n    const staticPatterns = positivePatterns.filter((pattern) => utils.pattern.isStaticPattern(pattern, settings));\n    const dynamicPatterns = positivePatterns.filter((pattern) => utils.pattern.isDynamicPattern(pattern, settings));\n    const staticTasks = convertPatternsToTasks(staticPatterns, negativePatterns, /* dynamic */ false);\n    const dynamicTasks = convertPatternsToTasks(dynamicPatterns, negativePatterns, /* dynamic */ true);\n    return staticTasks.concat(dynamicTasks);\n}\nexports.generate = generate;\n/**\n * Returns tasks grouped by basic pattern directories.\n *\n * Patterns that can be found inside (`./`) and outside (`../`) the current directory are handled separately.\n * This is necessary because directory traversal starts at the base directory and goes deeper.\n */\nfunction convertPatternsToTasks(positive, negative, dynamic) {\n    const tasks = [];\n    const patternsOutsideCurrentDirectory = utils.pattern.getPatternsOutsideCurrentDirectory(positive);\n    const patternsInsideCurrentDirectory = utils.pattern.getPatternsInsideCurrentDirectory(positive);\n    const outsideCurrentDirectoryGroup = groupPatternsByBaseDirectory(patternsOutsideCurrentDirectory);\n    const insideCurrentDirectoryGroup = groupPatternsByBaseDirectory(patternsInsideCurrentDirectory);\n    tasks.push(...convertPatternGroupsToTasks(outsideCurrentDirectoryGroup, negative, dynamic));\n    /*\n     * For the sake of reducing future accesses to the file system, we merge all tasks within the current directory\n     * into a global task, if at least one pattern refers to the root (`.`). In this case, the global task covers the rest.\n     */\n    if ('.' in insideCurrentDirectoryGroup) {\n        tasks.push(convertPatternGroupToTask('.', patternsInsideCurrentDirectory, negative, dynamic));\n    }\n    else {\n        tasks.push(...convertPatternGroupsToTasks(insideCurrentDirectoryGroup, negative, dynamic));\n    }\n    return tasks;\n}\nexports.convertPatternsToTasks = convertPatternsToTasks;\nfunction getPositivePatterns(patterns) {\n    return utils.pattern.getPositivePatterns(patterns);\n}\nexports.getPositivePatterns = getPositivePatterns;\nfunction getNegativePatternsAsPositive(patterns, ignore) {\n    const negative = utils.pattern.getNegativePatterns(patterns).concat(ignore);\n    const positive = negative.map(utils.pattern.convertToPositivePattern);\n    return positive;\n}\nexports.getNegativePatternsAsPositive = getNegativePatternsAsPositive;\nfunction groupPatternsByBaseDirectory(patterns) {\n    const group = {};\n    return patterns.reduce((collection, pattern) => {\n        const base = utils.pattern.getBaseDirectory(pattern);\n        if (base in collection) {\n            collection[base].push(pattern);\n        }\n        else {\n            collection[base] = [pattern];\n        }\n        return collection;\n    }, group);\n}\nexports.groupPatternsByBaseDirectory = groupPatternsByBaseDirectory;\nfunction convertPatternGroupsToTasks(positive, negative, dynamic) {\n    return Object.keys(positive).map((base) => {\n        return convertPatternGroupToTask(base, positive[base], negative, dynamic);\n    });\n}\nexports.convertPatternGroupsToTasks = convertPatternGroupsToTasks;\nfunction convertPatternGroupToTask(base, positive, negative, dynamic) {\n    return {\n        dynamic,\n        positive,\n        negative,\n        base,\n        patterns: [].concat(positive, negative.map(utils.pattern.convertToNegativePattern))\n    };\n}\nexports.convertPatternGroupToTask = convertPatternGroupToTask;\n"]},"metadata":{},"sourceType":"script"}